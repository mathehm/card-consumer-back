{
  "info": {
    "name": "Card Consumer API - Wallet",
    "description": "Collection para testar a API de carteira digital com transações atômicas",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Wallet Operations",
      "item": [
        {
          "name": "1. Registrar Nova Carteira",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"code\": 12345,\n  \"balance\": 100.50,\n  \"user\": {\n    \"name\": \"João Silva\",\n    \"phone\": \"(11) 99999-9999\"\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/wallet/register",
              "host": ["{{baseUrl}}"],
              "path": ["wallet", "register"]
            },
            "description": "Cria uma nova carteira com usuário. Operação com transação atômica."
          },
          "response": []
        },
        {
          "name": "2. Consultar Carteira",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/wallet/{{walletCode}}",
              "host": ["{{baseUrl}}"],
              "path": ["wallet", "{{walletCode}}"]
            },
            "description": "Consulta uma carteira pelo código, retorna saldo, dados do usuário e histórico de transações."
          },
          "response": []
        },
        {
          "name": "3. Adicionar Crédito",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"value\": 50.00\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/wallet/{{walletCode}}/credit",
              "host": ["{{baseUrl}}"],
              "path": ["wallet", "{{walletCode}}", "credit"]
            },
            "description": "Adiciona crédito à carteira. Operação com transação atômica (saldo + histórico)."
          },
          "response": []
        },
        {
          "name": "4. Realizar Débito",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"value\": 25.00\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/wallet/{{walletCode}}/debit",
              "host": ["{{baseUrl}}"],
              "path": ["wallet", "{{walletCode}}", "debit"]
            },
            "description": "Realiza débito da carteira. Operação com transação atômica e verificação de saldo."
          },
          "response": []
        },
        {
          "name": "5. Transferir Saldo",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"toCode\": 67890,\n  \"value\": 30.00\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/wallet/{{walletCode}}/transfer",
              "host": ["{{baseUrl}}"],
              "path": ["wallet", "{{walletCode}}", "transfer"]
            },
            "description": "Transfere saldo entre carteiras. Operação com transação atômica, descrições automáticas e ID único."
          },
          "response": []
        },
        {
          "name": "6. Remover Carteira",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/wallet/{{walletCode}}",
              "host": ["{{baseUrl}}"],
              "path": ["wallet", "{{walletCode}}"]
            },
            "description": "Remove completamente a carteira. Operação com transação atômica (carteira + usuário + transações)."
          },
          "response": []
        }
      ]
    },
    {
      "name": "Testes de Validação",
      "item": [
        {
          "name": "Teste: Carteira com Código Duplicado",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"code\": 12345,\n  \"balance\": 200,\n  \"user\": {\n    \"name\": \"Maria Santos\",\n    \"phone\": \"(11) 88888-8888\"\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/wallet/register",
              "host": ["{{baseUrl}}"],
              "path": ["wallet", "register"]
            },
            "description": "Tenta criar carteira com código já existente. Deve retornar erro."
          },
          "response": []
        },
        {
          "name": "Teste: Débito com Saldo Insuficiente",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"value\": 1000.00\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/wallet/{{walletCode}}/debit",
              "host": ["{{baseUrl}}"],
              "path": ["wallet", "{{walletCode}}", "debit"]
            },
            "description": "Tenta debitar valor maior que o saldo. Deve retornar erro de saldo insuficiente."
          },
          "response": []
        },
        {
          "name": "Teste: Carteira Inexistente",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/wallet/99999",
              "host": ["{{baseUrl}}"],
              "path": ["wallet", "99999"]
            },
            "description": "Consulta carteira que não existe. Deve retornar erro 404."
          },
          "response": []
        }
      ]
    },
    {
      "name": "Testes de Múltiplas Carteiras",
      "item": [
        {
          "name": "Criar Carteira A",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"code\": 11111,\n  \"balance\": 500,\n  \"user\": {\n    \"name\": \"Ana Costa\",\n    \"phone\": \"(11) 77777-7777\"\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/wallet/register",
              "host": ["{{baseUrl}}"],
              "path": ["wallet", "register"]
            }
          },
          "response": []
        },
        {
          "name": "Criar Carteira B",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"code\": 22222,\n  \"balance\": 300,\n  \"user\": {\n    \"name\": \"Carlos Oliveira\",\n    \"phone\": \"(11) 66666-6666\"\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/wallet/register",
              "host": ["{{baseUrl}}"],
              "path": ["wallet", "register"]
            }
          },
          "response": []
        },
        {
          "name": "Transações na Carteira A",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"value\": 100\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/wallet/11111/credit",
              "host": ["{{baseUrl}}"],
              "path": ["wallet", "11111", "credit"]
            }
          },
          "response": []
        },
        {
          "name": "Transações na Carteira B",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"value\": 50\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/wallet/22222/debit",
              "host": ["{{baseUrl}}"],
              "path": ["wallet", "22222", "debit"]
            }
          },
          "response": []
        },
        {
          "name": "8. Cancelar Transação",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"transactionId\": \"FIRESTORE_TRANSACTION_ID_AQUI\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/wallet/{{walletCode}}/cancel-transaction",
              "host": ["{{baseUrl}}"],
              "path": ["wallet", "{{walletCode}}", "cancel-transaction"]
            },
            "description": "Cancela uma transação específica e reverte seus efeitos automaticamente. As descrições são geradas automaticamente pelo backend. Requer apenas o ID da transação (obtido na consulta da carteira)."
          },
          "response": []
        }
      ]
    }
  ],
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:3000",
      "type": "string"
    },
    {
      "key": "walletCode",
      "value": "12345",
      "type": "string"
    }
  ]
}
